{"version":3,"sources":["../../src/pages/capture-pic/capture-pic.module.ts","../../src/pages/capture-pic/capture-pic.ts"],"names":[],"mappings":"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","file":"64.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { CapturePicPage } from './capture-pic';\n\n@NgModule({\n  declarations: [\n    CapturePicPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(CapturePicPage),\n  ],\n})\nexport class CapturePicPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/capture-pic/capture-pic.module.ts","import { Component } from \"@angular/core\";\nimport { IonicPage, NavController, NavParams, LoadingController, ModalController } from \"ionic-angular\";\nimport { Camera, CameraOptions } from \"@ionic-native/camera\";\nimport { ToastController } from 'ionic-angular';\nimport { Http, Headers, RequestOptions } from '@angular/http';\nimport { AuthData } from \"../../providers/auth-data\";\nimport { AngularFireAuth } from \"angularfire2/auth\";\n\nimport { AngularFireDatabase, FirebaseListObservable } from 'angularfire2/database-deprecated';\nimport { GalleryModal } from 'ionic-gallery-modal';\n\n@IonicPage({\n  name: \"CapturePicPage\"\n})\n@Component({\n  selector: \"page-capture-pic\",\n  templateUrl: \"capture-pic.html\"\n})\nexport class CapturePicPage {\n  //\n  loaded: boolean ;\n  imgGallery: FirebaseListObservable<any[]>;\n  imgGalleryArray : any=[]; \n  photos: any[] = [];\n  getIndex:number;\n  galleryView: string = \"three\";\n  //\n\n  uid: string; \n\n  constructor(\n    public navCtrl: NavController,\n    public navParams: NavParams,\n    private camera: Camera,\n    private toastCtrl: ToastController,\n    public http: Http,\n    private auth: AuthData,\n    private afAuth: AngularFireAuth,\n    public loadingCtrl: LoadingController,\n    public afDB: AngularFireDatabase,\n    public modalCtrl: ModalController\n  ) {\n\n    // Gallary \n    let loadingPopup = this.loadingCtrl.create({\n      spinner: 'crescent', \n      content: ''\n    });\n    loadingPopup.present();\n    this.imgGallery = afDB.list('/gallery');\n    this.imgGallery.subscribe(imgGallery => {\n        this.imgGalleryArray = imgGallery;\n        loadingPopup.dismiss()\n    })\n\n  }\n\n\n  // Gallery\n  fullscreenImage(getIndex) {\n    //console.log(\"NEW ==== getIndex=\"+getIndex);\n    let modal = this.modalCtrl.create(GalleryModal,  {\n        // For multiple images //\n        photos:   this.imgGalleryArray ,\n        // For single image //\n        // photos: [{url:getImage}], \n      closeIcon: 'close-circle',\n      initialSlide: getIndex \n      });\n      // console.log(\"getIndex=\"+getIndex);\n    modal.present();\n  }\n\n\n\n  ionViewDidLoad() {\n    console.log(\"ionViewDidLoad CapturePicPage\");\n\n    this.afAuth.authState.subscribe(userAuth => {\n     \n        if(userAuth) {\n          this.uid = userAuth.uid;  \n          console.log(\"auth true!: \", this.uid);\n        }\n      });\n  }\n\n\n  // takes and sends the picture to the server\n  takePicture() {\n    const options: CameraOptions = {\n      quality: 50,\n      correctOrientation: true,\n      destinationType: this.camera.DestinationType.DATA_URL,\n      encodingType: this.camera.EncodingType.JPEG,\n      mediaType: this.camera.MediaType.PICTURE,\n      cameraDirection: 1\n    };\n\n    this.camera.getPicture(options).then(\n      imageData => {\n        // imageData is either a base64 encoded string or a file URI\n        // If it's base64:\n        let base64Image = imageData; // \"data:image/jpeg;base64,\" + imageData;\n        console.log(base64Image);\n        this.showToast(\"Success: Analyzing the picture.\");\n        this.postRequest(base64Image);\n      },\n      err => {\n        // Handle error\n        console.log(\"There was an error taking the picture: \" + err);\n        this.showToast(\"Error Getting the picture!\");\n      } // err\n    ); // then\n  } // takePicture\n\n\n\n  private showToast(message: string) {\n    let toast = this.toastCtrl.create({\n      message: message,\n      duration: 2000,\n      position: 'bottom'\n    });\n  \n    toast.onDidDismiss(() => {\n      console.log('Dismissed toast');\n    });\n  \n    toast.present();\n  }\n\n\n  // makes a post Request and sends picture data to /fileUpload\n  async postRequest(pData: any) {\n    return new Promise((resolve , reject)=> {\n\n      this.showToast(\"Sending Post Req\");\n      var headers = new Headers();\n      // headers.append(\"Accept\", 'application/json');\n      // headers.append('Content-Type', 'application/json' );\n      let options = new RequestOptions({ headers: headers });\n  \n      let postParams = {\n        uid: this.uid,\n        picture: pData\n      }\n      \n      try{\n        this.http.post(\"https://clonedevtests-juandiegoio.c9users.io/fileUpload\", postParams, options)\n          .subscribe(data => {\n            let joyLikelihood = data.json().filename;\n            this.showToast(\"Data: \" + joyLikelihood);\n            console.log(data);\n            resolve(data);\n           }, error => {\n            console.log(error);// Error getting the data\n            this.showToast(\"Post Req Err: .\" + error);\n            reject(error);\n          }); // subscribe \n      }\n      catch (e) { \n        console.log(\"Error sending the picture.\");\n        this.showToast(\"Error: Sorry image could not be sent to our servers.\")\n      }\n    }); // Promise\n  } // postRequest\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/capture-pic/capture-pic.ts"],"sourceRoot":""}