{"version":3,"sources":["../../src/pages/capture-pic/capture-pic.module.ts","../../src/pages/capture-pic/capture-pic.ts"],"names":[],"mappings":"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","file":"65.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { CapturePicPage } from './capture-pic';\n\n@NgModule({\n  declarations: [\n    CapturePicPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(CapturePicPage),\n  ],\n})\nexport class CapturePicPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/capture-pic/capture-pic.module.ts","import { Component } from \"@angular/core\";\nimport {\n  IonicPage,\n  NavController,\n  NavParams,\n  LoadingController,\n  ModalController,\n  AlertController\n} from \"ionic-angular\";\nimport { Camera, CameraOptions } from \"@ionic-native/camera\";\nimport { ToastController } from \"ionic-angular\";\nimport { Http, Headers, RequestOptions } from \"@angular/http\";\nimport { AuthData } from \"../../providers/auth-data\";\nimport { AngularFireAuth } from \"angularfire2/auth\";\n\nimport {\n  AngularFireDatabase,\n  FirebaseListObservable\n} from \"angularfire2/database-deprecated\";\nimport { GalleryModal } from \"ionic-gallery-modal\";\n\n@IonicPage({\n  name: \"CapturePicPage\"\n})\n@Component({\n  selector: \"page-capture-pic\",\n  templateUrl: \"capture-pic.html\"\n})\nexport class CapturePicPage {\n  //\n  loaded: boolean;\n  imgGallery: FirebaseListObservable<any[]>;\n  imgGalleryArray: any = [];\n  photos: any[] = [];\n  getIndex: number;\n  galleryView: string = \"three\";\n  SERVER_URL = \"https://clonedevtests-juandiegoio.c9users.io\";\n  //\n\n  uid: string;\n\n  constructor(\n    public navCtrl: NavController,\n    public navParams: NavParams,\n    private camera: Camera,\n    private toastCtrl: ToastController,\n    public http: Http,\n    private auth: AuthData,\n    private afAuth: AngularFireAuth,\n    public loadingCtrl: LoadingController,\n    public afDB: AngularFireDatabase,\n    public modalCtrl: ModalController,\n    private alertCtrl: AlertController\n  ) {}\n\n  // Gallery\n  fullscreenImage(getIndex) {\n    //console.log(\"NEW ==== getIndex=\"+getIndex);\n    let modal = this.modalCtrl.create(GalleryModal, {\n      // For multiple images //\n      photos: this.imgGalleryArray,\n      // For single image //\n      // photos: [{url:getImage}],\n      closeIcon: \"close-circle\",\n      initialSlide: getIndex\n    });\n    // console.log(\"getIndex=\"+getIndex);\n    modal.present();\n  }\n\n  ionViewDidLoad() {\n    console.log(\"ionViewDidLoad CapturePicPage\");\n\n    this.afAuth.authState.subscribe(userAuth => {\n      if (userAuth) {\n        this.uid = userAuth.uid;\n        console.log(\"auth true!: \", this.uid);\n\n        // Gallery shit\n\n        // Gallary\n        let loadingPopup = this.loadingCtrl.create({\n          spinner: \"crescent\",\n          content: \"\"\n        });\n        loadingPopup.present();\n        this.imgGallery = this.afDB.list(\"/Expressions/\" + this.uid);\n        this.imgGallery.subscribe(imgGallery => {\n          this.imgGalleryArray = imgGallery;\n          loadingPopup.dismiss();\n        });\n      }\n    });\n  }\n\n  // takes and sends the picture to the server\n  takePicture() {\n    const options: CameraOptions = {\n      quality: 50,\n      correctOrientation: true,\n      destinationType: this.camera.DestinationType.DATA_URL,\n      encodingType: this.camera.EncodingType.JPEG,\n      mediaType: this.camera.MediaType.PICTURE,\n      cameraDirection: 1\n    };\n\n    this.camera.getPicture(options).then(\n      imageData => {\n        // imageData is either a base64 encoded string or a file URI\n        // If it's base64:\n        let base64Image = imageData; // \"data:image/jpeg;base64,\" + imageData;\n        this.showToast(\"Success: Analyzing the picture.\");\n        this.postRequest(base64Image);\n      },\n      err => {\n        // Handle error\n        console.log(\"There was an error taking the picture: \" + err);\n        this.showToast(\"Error Getting the picture!\");\n      } // err\n    ); // then\n  } // takePicture\n\n  private showToast(message: string) {\n    let toast = this.toastCtrl.create({\n      message: message,\n      duration: 2000,\n      position: \"bottom\"\n    });\n\n    toast.onDidDismiss(() => {\n      console.log(\"Dismissed toast\");\n    });\n\n    toast.present();\n  }\n\n  // makes a post Request and sends picture data to /fileUpload\n  async postRequest(pData: any) {\n    return new Promise((resolve, reject) => {\n      this.showToast(\"Sending Post Req\");\n      var headers = new Headers();\n      // headers.append(\"Accept\", 'application/json');\n      // headers.append('Content-Type', 'application/json' );\n      let options = new RequestOptions({ headers: headers });\n\n      let postParams = {\n        uid: this.uid,\n        picture: pData\n      };\n\n      try {\n        this.http\n          .post(\n            \"https://clonedevtests-juandiegoio.c9users.io/fileUpload\",\n            postParams,\n            options\n          )\n          .subscribe(\n            data => {\n              let emotion = data.json().emotion;\n              this.showAlert(\"Picture Analysis\", emotion);\n              console.log(data);\n              resolve(data);\n            },\n            error => {\n              console.log(error); // Error getting the data\n              this.showToast(\"Post Req Err: .\" + error);\n              reject(error);\n            }\n          ); // subscribe\n      } catch (e) {\n        console.log(\"Error sending the picture.\");\n        this.showToast(\"Error: Sorry image could not be sent to our servers.\");\n      }\n    }); // Promise\n  } // postRequest\n\n\n  private showAlert(title: string, message: string){\n      let alert = this.alertCtrl.create({\n        title: title,\n        subTitle: message,\n        buttons: ['Done']\n      });\n      alert.present();\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/capture-pic/capture-pic.ts"],"sourceRoot":""}